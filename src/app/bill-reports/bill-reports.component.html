<div id="section-container">
  <div id="content">
    <h2 id="main-header">Reportes de Facturas Electrónicas</h2>
    <hr class="style-one">
    <p class="content-header">Ingrese el o los filtros a aplicar en la búsqueda</p>
    <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
      <div id="filters-container">
        <div align="center">
          <div class="filter-input">
            <p>
              <mat-form-field appearance="standard" class="input-medium">
                <mat-label>Identificación</mat-label>
                <input matInput (input)="onNumberInput($event)" placeholder="Ingresa el número de Identificación"
                  class="form-control" formControlName="identification"
                  [ngClass]="{ 'is-invalid': submitted && f.identification.errors }">
                <mat-icon matSuffix>credit_card</mat-icon>
                <mat-hint>Longitud min: 9 digitos</mat-hint>
                <mat-error *ngIf="isCrdLengthCorrect=='false'">El número Identificacion debe tener 9 dígitos
                  min</mat-error>
              </mat-form-field>
            </p>
          </div>
          <img class="vertical-line" src="../assets/img/vertical-line.png">
          <div class="filter-input">
            <p>
              <mat-form-field appearance="standard" class="input-long">
                <mat-label>Número de documento</mat-label>
                <input matInput (input)="onNumberInput($event)" placeholder="Ingresa el número de documento"
                  class="form-control" formControlName="consecutiveNumber"
                  [ngClass]="{ 'is-invalid': submitted && f.consecutiveNumber.errors }">
                <mat-icon matSuffix>receipt</mat-icon>
                <mat-hint>Longitud: 20 caracteres</mat-hint>
                <mat-error *ngIf="isActLengthCorrect=='false'">El número de documento debe tener 20
                  caracteres</mat-error>
              </mat-form-field>
            </p>
          </div>
          <img class="vertical-line" src="../assets/img/vertical-line.png">
          <div class="filter-input">
            <mat-form-field class="example-full-width" id="date-small">
              <input matInput [matDatepicker]="pickerFrom" placeholder="Factura desde" class="form-control"
                formControlName="dateFrom" [ngClass]="{ 'is-invalid': submitted && f.dateFrom.errors }">
              <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
              <mat-datepicker touchUi #pickerFrom></mat-datepicker>
              <mat-hint>mm/dd/aaaa</mat-hint>
            </mat-form-field>
          </div>
          <img class="vertical-line" src="../assets/img/vertical-line.png">
          <div class="filter-input">
            <mat-form-field class="example-full-width" id="date-small">
              <input matInput [matDatepicker]="pickerTo" placeholder="Hasta" class="form-control"
                formControlName="dateTo" [ngClass]="{ 'is-invalid': submitted && f.dateTo.errors }">
              <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
              <mat-datepicker touchUi #pickerTo></mat-datepicker>
              <mat-hint>mm/dd/aaaa</mat-hint>
            </mat-form-field>
          </div>

        </div>
        <!--fin de align-->
      </div>
      <div id="search-button">
        <button mat-raised-button [disabled]="isFilterNotExists() || myForm.invalid || isDateRangeInvalid()"
          color="primary" class="credix-theme"><i class="material-icons">search</i>Buscar</button>
      </div>
    </form>
    <div class="example-container mat-elevation-z8" id="data-table">
      <div class="example-loading-shade" *ngIf="isLoadingResults">
        <mat-spinner [diameter]="60" *ngIf="isLoadingResults"></mat-spinner>
      </div>

      <div class="search-table">
        <mat-form-field>
          <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Buscar...">
          <mat-hint>Puedes buscar por cualquier elemento de la lista</mat-hint>
        </mat-form-field>

        <div class="search-table__button"  >
          <button (click)="export()" [disabled]="dataSource.data.length == 0" mat-raised-button  color="primary" class="credix-theme"><mat-icon>file_download</mat-icon> Exportar</button>
        </div>
      </div>

      <table mat-table [dataSource]="dataSource" matSort>
        <!-- Position Column -->
        <ng-container matColumnDef="consecutiveNumber">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Número de documento </th>
          <td mat-cell *matCellDef="let element"> {{element.consecutiveNumber}} </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="billDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha de facturación </th>
          <td mat-cell *matCellDef="let element"> {{element.billDate}} </td>
        </ng-container>


        <!-- Symbol Column -->
        <ng-container matColumnDef="identification">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Identificación receptor </th>
          <td mat-cell *matCellDef="let element"> {{element.identification}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre receptor </th>
          <td mat-cell *matCellDef="let element"> {{element.name}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo de documento </th>
          <td mat-cell *matCellDef="let element"> {{element.description}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="currency">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Moneda </th>
          <td mat-cell *matCellDef="let element"> {{element.currency}} </td>
        </ng-container>


        <!-- Symbol Column -->
        <ng-container matColumnDef="finalSalePrice">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Subtotal Facturado </th>
          <td mat-cell *matCellDef="let element"> {{element.finalSalePrice}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="TaxTotal">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Monto IVA </th>
          <td mat-cell *matCellDef="let element"> {{element.TaxTotal}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="finalTotalPrice">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Monto final </th>
          <td mat-cell *matCellDef="let element"> {{element.finalTotalPrice}} </td>
        </ng-container>

        <ng-container matColumnDef="stateBill">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Estado <i class="material-icons"
              matTooltip="Este estado se encuentra registrado segun el envio de la factura al sistema de factura electronica hacienda"
              [matTooltipPosition]="'right'">
              info
            </i></th>
          <td mat-cell *matCellDef="let element"> {{element.stateBill}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let billReportsRows; columns: displayedColumns;"></tr>

      </table>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div>
  </div>
</div>
